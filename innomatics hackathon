{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "34e15ea9-fa17-4a18-b733-eb1c6fe1e1bd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>order_date</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>restaurant_name_order</th>\n",
       "      <th>name</th>\n",
       "      <th>city</th>\n",
       "      <th>membership</th>\n",
       "      <th>restaurant_name_master</th>\n",
       "      <th>cuisine</th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>2508</td>\n",
       "      <td>450</td>\n",
       "      <td>2023-02-18</td>\n",
       "      <td>842.97</td>\n",
       "      <td>New Foods Chinese</td>\n",
       "      <td>User_2508</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_450</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>3.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2693</td>\n",
       "      <td>309</td>\n",
       "      <td>2023-01-18</td>\n",
       "      <td>546.68</td>\n",
       "      <td>Ruchi Curry House Multicuisine</td>\n",
       "      <td>User_2693</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_309</td>\n",
       "      <td>Indian</td>\n",
       "      <td>4.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2084</td>\n",
       "      <td>107</td>\n",
       "      <td>2023-07-15</td>\n",
       "      <td>163.93</td>\n",
       "      <td>Spice Kitchen Punjabi</td>\n",
       "      <td>User_2084</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_107</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>319</td>\n",
       "      <td>224</td>\n",
       "      <td>2023-10-04</td>\n",
       "      <td>1155.97</td>\n",
       "      <td>Darbar Kitchen Non-Veg</td>\n",
       "      <td>User_319</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_224</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>4.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1064</td>\n",
       "      <td>293</td>\n",
       "      <td>2023-12-25</td>\n",
       "      <td>1321.91</td>\n",
       "      <td>Royal Eatery South Indian</td>\n",
       "      <td>User_1064</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_293</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   order_id  user_id  restaurant_id order_date  total_amount  \\\n",
       "0         1     2508            450 2023-02-18        842.97   \n",
       "1         2     2693            309 2023-01-18        546.68   \n",
       "2         3     2084            107 2023-07-15        163.93   \n",
       "3         4      319            224 2023-10-04       1155.97   \n",
       "4         5     1064            293 2023-12-25       1321.91   \n",
       "\n",
       "            restaurant_name_order       name       city membership  \\\n",
       "0               New Foods Chinese  User_2508  Hyderabad    Regular   \n",
       "1  Ruchi Curry House Multicuisine  User_2693       Pune    Regular   \n",
       "2           Spice Kitchen Punjabi  User_2084    Chennai       Gold   \n",
       "3          Darbar Kitchen Non-Veg   User_319  Bangalore       Gold   \n",
       "4       Royal Eatery South Indian  User_1064       Pune    Regular   \n",
       "\n",
       "  restaurant_name_master  cuisine  rating  \n",
       "0         Restaurant_450  Mexican     3.2  \n",
       "1         Restaurant_309   Indian     4.5  \n",
       "2         Restaurant_107  Mexican     4.0  \n",
       "3         Restaurant_224  Chinese     4.8  \n",
       "4         Restaurant_293  Italian     3.0  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import sqlite3\n",
    "orders_df = pd.read_csv(r\"C:\\Users\\errol\\Downloads\\orders.csv\")\n",
    "users_df = pd.read_json(r\"C:\\Users\\errol\\Downloads\\users.json\")\n",
    "conn = sqlite3.connect(':memory:')\n",
    "with open(r\"C:\\Users\\errol\\Downloads\\restaurants.sql\", 'r') as f:\n",
    "    sql_script = f.read()\n",
    "conn.executescript(sql_script)\n",
    "restaurants_df = pd.read_sql_query(\"SELECT * FROM restaurants\", conn)\n",
    "conn.close()\n",
    "merged_df = pd.merge(orders_df, users_df, on='user_id', how='left')\n",
    "final_df = pd.merge(merged_df, restaurants_df, on='restaurant_id', how='left', suffixes=('_order', '_master'))\n",
    "final_df['order_date'] = pd.to_datetime(final_df['order_date'], dayfirst=True)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "1e0879a8-2f3f-4d6d-bd27-f2915bb160e6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Chennai'"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gold_members = final_df[final_df['membership'] == 'Gold']\n",
    "gold_members.groupby('city')['total_amount'].sum().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "c7cadf58-9596-4c7f-9ba1-638fa5863d04",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Mexican'"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.groupby('cuisine')['total_amount'].mean().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "2f34468d-baf7-4694-aa80-069dcd1f917f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.int64(2544)"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_spend = final_df.groupby('user_id')['total_amount'].sum()\n",
    "(user_spend > 1000).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "7c13b478-07e9-40e1-92c5-7d02a564f6cc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'4.6 – 5.0'"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bins = [3.0, 3.5, 4.0, 4.5, 5.0]\n",
    "labels = ['3.0 – 3.5', '3.6 – 4.0', '4.1 – 4.5', '4.6 – 5.0']\n",
    "final_df['rating_range'] = pd.cut(final_df['rating'], bins=bins, labels=labels, include_lowest=True)\n",
    "final_df.groupby('rating_range', observed=True)['total_amount'].sum().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "cdcc52e1-bbdf-4529-a67f-1898f354abf0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Chennai'"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gold_df = final_df[final_df['membership'] == 'Gold']\n",
    "gold_df.groupby('city')['total_amount'].mean().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "f96cceaf-080f-4819-ba1a-1c9981f07b51",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Chinese'"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.groupby('cuisine')['restaurant_id'].nunique().idxmin()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "ebd7713b-e094-4c16-9358-20fddc8fc397",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "50"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gold_count = len(final_df[final_df['membership'] == 'Gold'])\n",
    "round((gold_count / len(final_df)) * 100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "6fa17229-9805-4a18-9001-b4c89d7e1c5e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Ruchi Foods Chinese'"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "options = ['Grand Cafe Punjabi', 'Grand Restaurant South Indian', 'Ruchi Mess Multicuisine', 'Ruchi Foods Chinese']\n",
    "stats = final_df.groupby('restaurant_name_order').agg(order_count=('order_id', 'count'), avg_val=('total_amount', 'mean'))\n",
    "stats[(stats.index.isin(options)) & (stats['order_count'] < 20)]['avg_val'].idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "a51e4053-15ef-48f9-961a-a9242abf7dc7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('Regular', 'Mexican')"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.groupby(['membership', 'cuisine'])['total_amount'].sum().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "c1f7a75e-8262-413a-9fcf-ee7c9d0b4d70",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.int32(3)"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df['order_date'] = pd.to_datetime(final_df['order_date'], dayfirst=True)\n",
    "final_df['quarter'] = final_df['order_date'].dt.quarter\n",
    "final_df.groupby('quarter')['total_amount'].sum().idxmax()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "b936e8a9-bbb0-42a0-bc49-64bc33c7ff2d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4987"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(final_df[final_df['membership'] == 'Gold'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "626e0d87-a639-4d4d-8fd2-ea2987379ef9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1889367"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "round(final_df[final_df['city'] == 'Hyderabad']['total_amount'].sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "7e2b24be-59c5-4404-adaf-f26f9c06d5da",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2883"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df['user_id'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "85e3f42a-3779-40f4-a60e-fefa3e18517f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.float64(797.15)"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "round(final_df[final_df['membership'] == 'Gold']['total_amount'].mean(), 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "16587ff4-e621-45b4-b1ed-d1e1f38be591",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3374"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(final_df[final_df['rating'] >= 4.5])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "38dc145e-de17-46eb-8f91-b3ff4e24f49c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1337"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "top_gold_city = final_df[final_df['membership'] == 'Gold'].groupby('city')['total_amount'].sum().idxmax()\n",
    "len(final_df[(final_df['membership'] == 'Gold') & (final_df['city'] == top_gold_city)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "21ca998c-83ed-4ffe-8413-009ba17cf68d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Orders columns: Index(['order_id', 'user_id', 'restaurant_id', 'order_date', 'total_amount',\n",
      "       'restaurant_name'],\n",
      "      dtype='object')\n",
      "Users columns: Index(['user_id', 'name', 'city', 'membership'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(\"Orders columns:\", orders_df.columns)\n",
    "print(\"Users columns:\", users_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "0213df02-c111-4ca9-9bc0-c0b862e9279c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'.sql'"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import os\n",
    "os.path.splitext('restaurants.sql')[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "db50a9a8-d554-4137-91ad-da6e2876364d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "10000"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(final_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "d25cff62-2595-4c79-8e96-628696831d5b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "order_id                  0\n",
       "user_id                   0\n",
       "restaurant_id             0\n",
       "order_date                0\n",
       "total_amount              0\n",
       "restaurant_name_order     0\n",
       "name                      0\n",
       "city                      0\n",
       "membership                0\n",
       "restaurant_name_master    0\n",
       "cuisine                   0\n",
       "rating                    0\n",
       "rating_range              0\n",
       "quarter                   0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "8d9914c2-8d6a-4242-b0dc-4e0355e61e83",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "merge\n"
     ]
    }
   ],
   "source": [
    "print(pd.merge.__name__)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d3edda41-efe8-4e4c-8399-b3ae0ed40793",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "True\n"
     ]
    }
   ],
   "source": [
    "print('membership' in users_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "595af772-494e-427f-ad55-b83c2be6d6ba",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Orders columns: Index(['order_id', 'user_id', 'restaurant_id', 'order_date', 'total_amount',\n",
      "       'restaurant_name'],\n",
      "      dtype='object')\n",
      "Restaurants columns: Index(['restaurant_id', 'restaurant_name', 'cuisine', 'rating'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(\"Orders columns:\", orders_df.columns)\n",
    "print(\"Restaurants columns:\", restaurants_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "ef619d0e-ccf0-4d93-b3e6-853611738a78",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Mexican', 'Indian', 'Chinese', 'Italian'], dtype=object)"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df['cuisine'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "a845fdfd-0fc9-4531-a38e-c7f907bcfe97",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>order_date</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>restaurant_name_order</th>\n",
       "      <th>name</th>\n",
       "      <th>city</th>\n",
       "      <th>membership</th>\n",
       "      <th>restaurant_name_master</th>\n",
       "      <th>cuisine</th>\n",
       "      <th>rating</th>\n",
       "      <th>rating_range</th>\n",
       "      <th>quarter</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>819</th>\n",
       "      <td>820</td>\n",
       "      <td>2973</td>\n",
       "      <td>381</td>\n",
       "      <td>2023-11-22</td>\n",
       "      <td>527.55</td>\n",
       "      <td>New Delights North Indian</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_381</td>\n",
       "      <td>Italian</td>\n",
       "      <td>4.6</td>\n",
       "      <td>4.6 – 5.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2139</th>\n",
       "      <td>2140</td>\n",
       "      <td>2973</td>\n",
       "      <td>173</td>\n",
       "      <td>2023-08-21</td>\n",
       "      <td>228.14</td>\n",
       "      <td>Darbar Delights South Indian</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_173</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>3.7</td>\n",
       "      <td>3.6 – 4.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2884</th>\n",
       "      <td>2885</td>\n",
       "      <td>2973</td>\n",
       "      <td>139</td>\n",
       "      <td>2023-12-09</td>\n",
       "      <td>651.91</td>\n",
       "      <td>Ruchi Cafe South Indian</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_139</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>4.8</td>\n",
       "      <td>4.6 – 5.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3327</th>\n",
       "      <td>3328</td>\n",
       "      <td>2973</td>\n",
       "      <td>477</td>\n",
       "      <td>2023-07-25</td>\n",
       "      <td>502.65</td>\n",
       "      <td>Swagath Biryani North Indian</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_477</td>\n",
       "      <td>Indian</td>\n",
       "      <td>4.1</td>\n",
       "      <td>4.1 – 4.5</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3529</th>\n",
       "      <td>3530</td>\n",
       "      <td>2973</td>\n",
       "      <td>100</td>\n",
       "      <td>2023-03-24</td>\n",
       "      <td>216.45</td>\n",
       "      <td>Spice Delights Family Restaurant</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_100</td>\n",
       "      <td>Indian</td>\n",
       "      <td>3.3</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3631</th>\n",
       "      <td>3632</td>\n",
       "      <td>2973</td>\n",
       "      <td>345</td>\n",
       "      <td>2023-08-23</td>\n",
       "      <td>1167.25</td>\n",
       "      <td>Sai Tiffins Chinese</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_345</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>4.3</td>\n",
       "      <td>4.1 – 4.5</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4332</th>\n",
       "      <td>4333</td>\n",
       "      <td>2973</td>\n",
       "      <td>327</td>\n",
       "      <td>2023-03-27</td>\n",
       "      <td>982.68</td>\n",
       "      <td>Royal Tiffins Chinese</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_327</td>\n",
       "      <td>Indian</td>\n",
       "      <td>3.2</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4920</th>\n",
       "      <td>4921</td>\n",
       "      <td>2973</td>\n",
       "      <td>383</td>\n",
       "      <td>2023-11-27</td>\n",
       "      <td>295.94</td>\n",
       "      <td>Amma Biryani North Indian</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_383</td>\n",
       "      <td>Indian</td>\n",
       "      <td>3.1</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5040</th>\n",
       "      <td>5041</td>\n",
       "      <td>2973</td>\n",
       "      <td>464</td>\n",
       "      <td>2023-06-25</td>\n",
       "      <td>615.70</td>\n",
       "      <td>Ruchi Cafe Multicuisine</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_464</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.3</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7382</th>\n",
       "      <td>7383</td>\n",
       "      <td>2973</td>\n",
       "      <td>281</td>\n",
       "      <td>2023-08-15</td>\n",
       "      <td>1463.50</td>\n",
       "      <td>Swagath Cafe Non-Veg</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_281</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.8</td>\n",
       "      <td>3.6 – 4.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7737</th>\n",
       "      <td>7738</td>\n",
       "      <td>2973</td>\n",
       "      <td>259</td>\n",
       "      <td>2023-02-06</td>\n",
       "      <td>489.95</td>\n",
       "      <td>Amma Curry House Family Restaurant</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_259</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>3.7</td>\n",
       "      <td>3.6 – 4.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8484</th>\n",
       "      <td>8485</td>\n",
       "      <td>2973</td>\n",
       "      <td>363</td>\n",
       "      <td>2023-10-15</td>\n",
       "      <td>793.76</td>\n",
       "      <td>Annapurna Mess Pure Veg</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_363</td>\n",
       "      <td>Italian</td>\n",
       "      <td>4.9</td>\n",
       "      <td>4.6 – 5.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8910</th>\n",
       "      <td>8911</td>\n",
       "      <td>2973</td>\n",
       "      <td>426</td>\n",
       "      <td>2023-01-24</td>\n",
       "      <td>1127.59</td>\n",
       "      <td>Royal Foods Non-Veg</td>\n",
       "      <td>User_2973</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_426</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      order_id  user_id  restaurant_id order_date  total_amount  \\\n",
       "819        820     2973            381 2023-11-22        527.55   \n",
       "2139      2140     2973            173 2023-08-21        228.14   \n",
       "2884      2885     2973            139 2023-12-09        651.91   \n",
       "3327      3328     2973            477 2023-07-25        502.65   \n",
       "3529      3530     2973            100 2023-03-24        216.45   \n",
       "3631      3632     2973            345 2023-08-23       1167.25   \n",
       "4332      4333     2973            327 2023-03-27        982.68   \n",
       "4920      4921     2973            383 2023-11-27        295.94   \n",
       "5040      5041     2973            464 2023-06-25        615.70   \n",
       "7382      7383     2973            281 2023-08-15       1463.50   \n",
       "7737      7738     2973            259 2023-02-06        489.95   \n",
       "8484      8485     2973            363 2023-10-15        793.76   \n",
       "8910      8911     2973            426 2023-01-24       1127.59   \n",
       "\n",
       "                   restaurant_name_order       name       city membership  \\\n",
       "819            New Delights North Indian  User_2973  Hyderabad       Gold   \n",
       "2139        Darbar Delights South Indian  User_2973  Hyderabad       Gold   \n",
       "2884             Ruchi Cafe South Indian  User_2973  Hyderabad       Gold   \n",
       "3327        Swagath Biryani North Indian  User_2973  Hyderabad       Gold   \n",
       "3529    Spice Delights Family Restaurant  User_2973  Hyderabad       Gold   \n",
       "3631                 Sai Tiffins Chinese  User_2973  Hyderabad       Gold   \n",
       "4332               Royal Tiffins Chinese  User_2973  Hyderabad       Gold   \n",
       "4920           Amma Biryani North Indian  User_2973  Hyderabad       Gold   \n",
       "5040             Ruchi Cafe Multicuisine  User_2973  Hyderabad       Gold   \n",
       "7382                Swagath Cafe Non-Veg  User_2973  Hyderabad       Gold   \n",
       "7737  Amma Curry House Family Restaurant  User_2973  Hyderabad       Gold   \n",
       "8484             Annapurna Mess Pure Veg  User_2973  Hyderabad       Gold   \n",
       "8910                 Royal Foods Non-Veg  User_2973  Hyderabad       Gold   \n",
       "\n",
       "     restaurant_name_master  cuisine  rating rating_range  quarter  \n",
       "819          Restaurant_381  Italian     4.6    4.6 – 5.0        4  \n",
       "2139         Restaurant_173  Chinese     3.7    3.6 – 4.0        3  \n",
       "2884         Restaurant_139  Mexican     4.8    4.6 – 5.0        4  \n",
       "3327         Restaurant_477   Indian     4.1    4.1 – 4.5        3  \n",
       "3529         Restaurant_100   Indian     3.3    3.0 – 3.5        1  \n",
       "3631         Restaurant_345  Chinese     4.3    4.1 – 4.5        3  \n",
       "4332         Restaurant_327   Indian     3.2    3.0 – 3.5        1  \n",
       "4920         Restaurant_383   Indian     3.1    3.0 – 3.5        4  \n",
       "5040         Restaurant_464  Italian     3.3    3.0 – 3.5        2  \n",
       "7382         Restaurant_281  Italian     3.8    3.6 – 4.0        3  \n",
       "7737         Restaurant_259  Mexican     3.7    3.6 – 4.0        1  \n",
       "8484         Restaurant_363  Italian     4.9    4.6 – 5.0        4  \n",
       "8910         Restaurant_426  Chinese     3.5    3.0 – 3.5        1  "
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_counts = final_df['user_id'].value_counts()\n",
    "sample_user = user_counts.index[0]\n",
    "final_df[final_df['user_id'] == sample_user]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
